sap.ui.define(["sap/ui/core/mvc/ControllerExtension"],function(e,t,n){"use strict";return e.extend("businesshiringui.ext.controller.Object_of_Univ",{override:{onInit:function(){var e=this.base.getExtensionAPI().getModel()},routing:{onBeforeBinding:async function(){var e,t,n,i;var s=this.base.getExtensionAPI().getModel();var o;if(!s){console.error("Model is not available.");return}debugger;const r=window.location.href;console.log("Current URL:",r);const a=new URL(r);debugger;const l=a.hash.substring(1);const u=/\/College\(lectId='[^']*',cdum=([a-fA-F0-9\-]+),IsActiveEntity=[^)]*\)/;const c=u.exec(l);const d=c?c[1]:null;debugger;console.log("Extracted cdum value (UUID):",d);try{const e=await new Promise((e,t)=>{jQuery.ajax({url:m+"/College",method:"GET",dataType:"json",success:function(t){e(t)},error:function(e,n,i){t(new Error(n+": "+i))}})});const t=e.value;var g;for(let e of t){if(e.cdum===d){debugger;g=e.Status}}debugger;if(g==="In Process"||g==="Rejected"){var f=this.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("Edit")||e.getId().includes("Delete"))});f.forEach(function(e){e.setEnabled(false);e.setVisible(false)})}else if(g!=="Approved"){debugger;var f=this.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&(e.getId().includes("Edit")||e.getId().includes("Delete"))});f.forEach(function(e){e.setEnabled(false);e.setVisible(false)})}}catch(e){console.error("Can not fetch data")}var b=this.getView().getModel("ui");var v=b.oData.editMode;var h=this.base.getView().byId("businesshiringui::CollegeObjectPage--fe::CustomSubSection::Upload_File_Fragment--uploadSet");var E=h.getBindingInfo("items");var p=E.template;if(v=="Editable"){h.setUploadButtonInvisible(false);p.setVisibleRemove(true);p.setVisibleEdit(true);p.setEnabledEdit(true);h.setUploadEnabled(true)}else{h.setUploadButtonInvisible(true);p.setVisibleRemove(false);p.setVisibleEdit(false);h.setUploadEnabled(false)}var m;if(typeof s.getServiceUrl==="function"){m=s.getServiceUrl();console.log("Service URL:",m)}try{const i=await new Promise((e,t)=>{jQuery.ajax({url:m+"/Authority",method:"GET",dataType:"json",success:function(t){e(t)},error:function(e,n,i){t(new Error(n+": "+i))}})});const s=i.value;for(let t of s){if(t.user==="Admin"){e=t.email;console.log(e)}}if(sap.ushell&&sap.ushell.Container){n=sap.ushell.Container.getService("UserInfo");t=n.getEmail();if(t!==e){this.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")}).forEach(function(e){if(e.getId().includes("Delete")){e.setVisible(false)}else if(e.getId().includes("Edit")){e.setEnabled(false)}})}}}catch(e){console.error("Can not fetch auth data")}this.adjustUIControls()}}},adjustUIControls:function(){var e=this;var t=e.base.getView().findAggregatedObjects(true,function(e){return e.isA("sap.m.Button")&&e.getId().includes("Save")});var n=t[0];setTimeout(function(){if(n.getText().includes("Create")){n.setText("Send for Approval")}}.bind(this),1e3)}})});
//# sourceMappingURL=Object_of_Univ.controller.js.map